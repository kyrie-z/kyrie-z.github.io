<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/fa58449823ab4344.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/1a36663c02865c1c.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-eab9dc47eafd4afc.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-cc48c28d170fddc2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-c7efea4b65083e7f.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-f374b534e356ecb9.js" async="" crossorigin=""></script><script src="/_next/static/chunks/647-b237105082792b4e.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-b3b901fbdca77438.js" async=""></script><title>Why Ownership Matters | Zilong Zhou</title><meta name="description" content="A statically generated blog example using Next.js and Zilong Zhou."/><meta property="og:title" content="Why Ownership Matters | Zilong Zhou"/><meta property="og:description" content="A statically generated blog example using Next.js and Zilong Zhou."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Why Ownership Matters | Zilong Zhou"/><meta name="twitter:description" content="A statically generated blog example using Next.js and Zilong Zhou."/><meta name="next-size-adjust"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="__className_aaf875"><div class="min-h-screen"><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/">zzl Blog</a>.</h2><article class="mb-32"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">Why Ownership Matters</h1><div class="hidden md:block md:mb-12"><div class="flex items-center"><div class="text-xl font-bold">Joe Haddad</div></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="sm:mx-0"><img alt="Cover Image for Why Ownership Matters" loading="lazy" width="1300" height="630" decoding="async" data-nimg="1" class="shadow-sm w-full" style="color:transparent" srcSet="/_next/image?url=%2Fassets%2Fblog%2Fpreview%2Fcover.jpg&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fassets%2Fblog%2Fpreview%2Fcover.jpg&amp;w=3840&amp;q=75 2x" src="/_next/image?url=%2Fassets%2Fblog%2Fpreview%2Fcover.jpg&amp;w=3840&amp;q=75"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><div class="flex items-center"><div class="text-xl font-bold">Joe Haddad</div></div></div><div class="mb-12 text-right text-lg"><time dateTime="2023-06-07T05:15:20.114Z">June	7, 2023</time></div></div><div class="max-w-4xl mx-auto"><div class="markdown-styles_markdown__ORfR8"><p>WWDC 2023 introduced Swift 5.9, which brings a lot of new features. While macro is the most exciting thing, ownership doesn’t seem to have drawn much attention.</p>
<p>However, I think it’s one of the most important feature evolved over the years. Swift is now more expressive and more precise with it. Let’s explore.</p>
<h2>Value Types</h2>
<p>Before discussing ownership, let’s first talk about value types.</p>
<p>Swift has two kinds of types: <strong>reference types</strong>, and <strong>value types</strong>.</p>
<p>Reference types are reference-counted, heap-allocated objects. They have reference semantics when passed between functions. And typically, they can manage their underlying resources with <code>init</code> and <code>deinit</code> methods. When you write code like this:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">class</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Foo</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span>
<span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> x </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Foo</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> y </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> x</span></code></pre></pre>
<p>It creates a new reference to <code>x</code>, and no new objects are created.</p>
<p>Value types on the other hand, are just independent values. Before Swift 5.9, value types are copied when assigned to new variables. The same code above copies the value of <code>x</code> to <code>y</code>, and they literally represent different things.</p>
<p>Languages like C++ and Rust only have value types, but you can implement your own reference types via RAII.</p>
<h2>Trivial Types</h2>
<p>In C++, there is a concept called trivial class. A trivial class has trivial <a href="https://en.cppreference.com/w/cpp/language/copy_constructor#Trivial_copy_constructor">copy</a> &amp; <a href="https://en.cppreference.com/w/cpp/language/move_constructor#Trivial_move_constructor">move</a> constructor, and <a href="https://en.cppreference.com/w/cpp/language/destructor#Trivial_destructor">trivial destructor</a>, which means they can’t be user-defined.</p>
<p>Before Swift 5.9, all value types are like trivial types. When they are copied, their memory bytes are simply copied to the new locations. But the difference is, additional value witness functions may be executed to maintain the lifetime of the reference-type members (this is not how trivial types defined in C++, but we don’t have control).</p>
<p>Value types in Swift can’t implement RAII because they are trivial. And this is also how value types are designed in Swift. Value types like <code>CGRect</code>, <code>Date</code>, and <code>Character</code> all represent values, not resources. And we don’t need to worry about how to release their underlying resources, because they just don’t allocate resources manually.</p>
<p>Reference-type members in value types are specially handled, and it’s also automatically done by compiler. Value type like <code>String</code> actually requires extra heap buffer to store its variable-length contents, and the buffer has to be a class (reference type) to be managed properly.</p>
<h2>A Common Problem</h2>
<p>Reference types are good, you can allocate your own resources and Swift takes care of them by automatic reference counting. But they also have downsides: everything needs to be heap-allocated. In performance-sensitive scenarios, massive allocation of reference-type values can be unaffordable.</p>
<p>Let’s see a real-world example:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">struct</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> fd</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Int</span><span>
</span>
<span>  </span><span class="token" style="color:hsl(301, 63%, 40%)">init</span><span class="token" style="color:hsl(221, 87%, 60%)">?</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>filePath</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">String</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">guard</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> fd </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">try</span><span class="token" style="color:hsl(221, 87%, 60%)">?</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">openFile</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>at</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> filePath</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">else</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>      </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> </span><span class="token nil" style="color:hsl(35, 99%, 36%)">nil</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">self</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>fd </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> fd
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span>
<span>  </span><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token omit" style="color:hsl(301, 63%, 40%)">_</span><span> data</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Data</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span>
<span>  </span><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">close</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<p>The resource a file descriptor holds is just an integer. We definitely don’t want to use class just for automatic resource management. However, using structs means the resource can be leaked if we forget to call <code>close</code> method. Even worse, if the value is copied, we totally lose control of it:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> handleToFileA </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">try</span><span class="token" style="color:hsl(221, 87%, 60%)">!</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>filePath</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token string-literal" style="color:hsl(119, 34%, 47%)">&quot;/path/to/a&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> anotherHandleToFileA </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> handleToFileA
</span><span>anotherHandleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">close</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span>
<span>handleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">...</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// 💥 BOOM!</span></code></pre></pre>
<p>In the end, we have to avoid using structs to represent a file descriptor. What a sad story.</p>
<h2>Rust to the Rescue</h2>
<p>When it comes to Rust, you will find everything works just like a charm. Why?</p>
<p>First, value types don’t have to be trivial types, and they can have custom destructors:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-rust" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">impl</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Drop</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">for</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">OwnedFd</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token attribute" style="color:hsl(35, 99%, 36%)">#[inline]</span><span>
</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">fn</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">drop</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">&amp;</span><span class="token" style="color:hsl(301, 63%, 40%)">mut</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">self</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>        </span><span class="token" style="color:hsl(301, 63%, 40%)">unsafe</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>            </span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> _ </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="-opacity:0.8">libc</span><span class="token" style="-opacity:0.8;color:hsl(230, 8%, 24%)">::</span><span class="token" style="color:hsl(221, 87%, 60%)">close</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(301, 63%, 40%)">self</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>fd</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span>
</span><span>        </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<p>Second, all user-defined types are not copyable by default. They are moved when assigned:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-rust" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> handle_to_file_a </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">acquire_fd</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span>
</span>
<span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> another_handle_to_file_a </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> handle_to_file_a</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span> </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// note: value moved here</span><span>
</span><span></span><span class="token" style="color:hsl(221, 87%, 60%)">drop</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>another_handle_to_file_a</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span>
</span>
<span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> _ </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> handle_to_file_a</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">is_terminal</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span> </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// error: borrow of moved value: `handle_to_file_a`</span></code></pre></pre>
<p>Third, lifetimes are checked at compile-time. As the above code shows, using a moved value will result in an error.</p>
<p>While all types are value types in Rust, they can still be divided into 3 categories:</p>
<ol>
<li><strong>“POD” type:</strong> such types can be bit-wise copied, and they implement <code>Copy</code> trait. Instead of being moved, they are copied implicitly when assigned. Examples are <code>i32</code>, <code>Duration</code>, etc.</li>
<li><strong>Duplicatable type:</strong> they implement <code>Clone</code> trait and can be cloned explicitly. After cloned, the new value may refer to the same thing or another different thing, depends on the semantics of the type. Examples are <code>String</code>, <code>Arc</code>, etc.</li>
<li><strong>Exclusive type:</strong> they can’t be copied, nor can it be cloned. Examples are <code>File</code>, <code>Box&lt;T&gt;</code> (where <code>T</code> is not <code>Clone</code>), etc.</li>
</ol>
<p>These can cover almost all the cases we may meet, and the soundness is guaranteed by the compiler.</p>
<p>Another good thing of Rust is that it uses move semantics by default. With some rare exceptions (such as self-referential types), move semantics don’t make mistakes. You can progressively adopt <code>Copy</code> and <code>Clone</code> when you find it’s safe to do so.</p>
<p>All of these rules make up the unique feature of Rust: <strong><a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html">ownership</a></strong>.</p>
<h2>Ownership in Swift</h2>
<p>Swift 5.9 introduced <strong><a href="https://github.com/apple/swift-evolution/blob/main/proposals/0390-noncopyable-structs-and-enums.md">non-copyable types</a></strong>, which imply unique ownership. Value types that represent underlying resources are suitable to be non-copyable. By using it, developers can no longer copy a file descriptor by mistake. And since the ownership is unique, it’s also safe to release resources when the value goes out of scope, which enables you to add <code>deinit</code> to non-copyable structs / enums.</p>
<p>To make a type non-copyable, simply add <code>~Copyable</code> suppression annotation:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">struct</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">~</span><span class="token" style="color:hsl(35, 99%, 36%)">Copyable</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span>
<span>  consuming </span><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">close</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<p>The <code>consuming</code> modifier makes <code>close</code> method move the receiver. Now the code below becomes invalid:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> handleToFileA </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">try</span><span class="token" style="color:hsl(221, 87%, 60%)">!</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>filePath</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token string-literal" style="color:hsl(119, 34%, 47%)">&quot;/path/to/a&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(301, 63%, 40%)">let</span><span> anotherHandleToFileA </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> handleToFileA
</span><span>anotherHandleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">close</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span>
<span>handleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">...</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// error: &#x27;handleToFileA&#x27; used after consume</span></code></pre></pre>
<p>Assigning a variable of non-copyable type to another will be move assignment. But sometimes you need to use a value but don’t want to move it. It’s where borrow comes into the play. By marking a function or parameter <code>borrowing</code>, you can borrow it without consuming it:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">struct</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">~</span><span class="token" style="color:hsl(35, 99%, 36%)">Copyable</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span>
<span>  borrowing </span><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token omit" style="color:hsl(301, 63%, 40%)">_</span><span> data</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">Data</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span>
<span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// It&#x27;s ok to do this multiple times:</span><span>
</span><span>handleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">...</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span>handleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">...</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span>handleToFileA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(221, 87%, 60%)">write</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(221, 87%, 60%)">...</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></pre>
<p>Actually you don’t need an explicit <code>close</code> method, as non-copyable types support the RAII technique. You can just release your resources in <code>deinit</code>:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">struct</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">~</span><span class="token" style="color:hsl(35, 99%, 36%)">Copyable</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span>
<span>  </span><span class="token" style="color:hsl(301, 63%, 40%)">deinit</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// Called when the file descriptor leaves the scope.</span><span>
</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<p>Other functions that consume non-copyable values also take the ownership of them:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">flushAndClose</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token omit" style="color:hsl(301, 63%, 40%)">_</span><span> fd</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> consuming </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// ...</span><span>
</span>
<span>  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// `deinit` of `fd` is called here.</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<p>And it’s not allowed to consume a borrowed value:</p>
<pre><pre class="text-sm" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-swift" style="background:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(301, 63%, 40%)">func</span><span> </span><span class="token function-definition" style="color:hsl(221, 87%, 60%)">appendSomething</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>to fd</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> borrowing </span><span class="token" style="color:hsl(35, 99%, 36%)">FileDescriptor</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(221, 87%, 60%)">flushAndClose</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>fd</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">// error: &#x27;fd&#x27; has guaranteed ownership but was consumed</span><span>
</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">}</span></code></pre></pre>
<h2>Closing up</h2>
<p>Ownership is a really great feature that enables us to write memory-safe code, while not introducing additional overheads. It’s a kind of zero-cost abstraction, which is very necessary for system programming. Although Swift doesn’t have mandatory adoption requirement of ownership, you should still be aware of it and take advantage of it as much as possible.</p></div></div></article></div></main></div><script src="/_next/static/chunks/webpack-eab9dc47eafd4afc.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/fa58449823ab4344.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L3\"\n"])</script><script>self.__next_f.push([1,"4:HL[\"/_next/static/css/1a36663c02865c1c.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[7690,[],\"\"]\n8:I[5613,[],\"\"]\na:I[1778,[],\"\"]\nc:I[8955,[],\"\"]\n9:[\"slug\",\"why-ownership-matters\",\"d\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fa58449823ab4344.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"u2GPBZ01wh5YvSkkIbJmK\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/why-ownership-matters\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"why-ownership-matters\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"why-ownership-matters\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"why-ownership-matters\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",\"$L7\",null]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$9\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1a36663c02865c1c.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_aaf875\",\"children\":[\"$\",\"div\",null,{\"className\":\"min-h-screen\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]}]]}],null]],\"initialHead\":[false,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]]\n"])</script><script>self.__next_f.push([1,"e:I[5250,[\"647\",\"static/chunks/647-b237105082792b4e.js\",\"333\",\"static/chunks/app/posts/%5Bslug%5D/page-b3b901fbdca77438.js\"],\"\"]\nf:I[1749,[\"647\",\"static/chunks/647-b237105082792b4e.js\",\"333\",\"static/chunks/app/posts/%5Bslug%5D/page-b3b901fbdca77438.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"main\",null,{\"children\":[false,[\"$\",\"div\",null,{\"className\":\"container mx-auto px-5\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8\",\"children\":[[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"hover:underline\",\"children\":\"zzl Blog\"}],\".\"]}],[\"$\",\"article\",null,{\"className\":\"mb-32\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left\",\"children\":\"Why Ownership Matters\"}],[\"$\",\"div\",null,{\"className\":\"hidden md:block md:mb-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"text-xl font-bold\",\"children\":\"Joe Haddad\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"mb-8 md:mb-16 sm:mx-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"sm:mx-0\",\"children\":[\"$\",\"$Lf\",null,{\"src\":\"/assets/blog/preview/cover.jpg\",\"alt\":\"Cover Image for Why Ownership Matters\",\"className\":\"shadow-sm w-full\",\"width\":1300,\"height\":630}]}]}],[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"block md:hidden mb-6\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"text-xl font-bold\",\"children\":\"Joe Haddad\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"mb-12 text-right text-lg\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2023-06-07T05:15:20.114Z\",\"children\":\"June\\t7, 2023\"}]}]]}]],[\"$\",\"div\",null,{\"className\":\"max-w-4xl mx-auto\",\"children\":[\"$\",\"div\",null,{\"className\":\"markdown-styles_markdown__ORfR8\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":\"WWDC 2023 introduced Swift 5.9, which brings a lot of new features. While macro is the most exciting thing, ownership doesn’t seem to have drawn much attention.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"However, I think it’s one of the most important feature evolved over the years. Swift is now more expressive and more precise with it. Let’s explore.\"}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"children\":\"Value Types\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"Before discussing ownership, let’s first talk about value types.\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"Swift has two kinds of types: \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"reference types\"}],\", and \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"value types\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":[\"Reference types are reference-counted, heap-allocated objects. They have reference semantics when passed between functions. And typically, they can manage their underlying resources with \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"init\"}],\" and \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"deinit\"}],\" methods. When you write code like this:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"class\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Foo\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" x \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Foo\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" y \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" x\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"It creates a new reference to \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"x\"}],\", and no new objects are created.\"]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":[\"Value types on the other hand, are just independent values. Before Swift 5.9, value types are copied when assigned to new variables. The same code above copies the value of \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"x\"}],\" to \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"y\"}],\", and they literally represent different things.\"]}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"Languages like C++ and Rust only have value types, but you can implement your own reference types via RAII.\"}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"children\":\"Trivial Types\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"In C++, there is a concept called trivial class. A trivial class has trivial \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://en.cppreference.com/w/cpp/language/copy_constructor#Trivial_copy_constructor\",\"children\":\"copy\"}],\" \u0026 \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://en.cppreference.com/w/cpp/language/move_constructor#Trivial_move_constructor\",\"children\":\"move\"}],\" constructor, and \",[\"$\",\"a\",\"a-2\",{\"href\":\"https://en.cppreference.com/w/cpp/language/destructor#Trivial_destructor\",\"children\":\"trivial destructor\"}],\", which means they can’t be user-defined.\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"Before Swift 5.9, all value types are like trivial types. When they are copied, their memory bytes are simply copied to the new locations. But the difference is, additional value witness functions may be executed to maintain the lifetime of the reference-type members (this is not how trivial types defined in C++, but we don’t have control).\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":[\"Value types in Swift can’t implement RAII because they are trivial. And this is also how value types are designed in Swift. Value types like \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"CGRect\"}],\", \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Date\"}],\", and \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Character\"}],\" all represent values, not resources. And we don’t need to worry about how to release their underlying resources, because they just don’t allocate resources manually.\"]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"Reference-type members in value types are specially handled, and it’s also automatically done by compiler. Value type like \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"String\"}],\" actually requires extra heap buffer to store its variable-length contents, and the buffer has to be a class (reference type) to be managed properly.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"children\":\"A Common Problem\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":\"Reference types are good, you can allocate your own resources and Swift takes care of them by automatic reference counting. But they also have downsides: everything needs to be heap-allocated. In performance-sensitive scenarios, massive allocation of reference-type values can be unaffordable.\"}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"Let’s see a real-world example:\"}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" fd\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Int\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"init\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"filePath\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"String\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"guard\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" fd \"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"try\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"openFile\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"at\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" filePath\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token nil\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"nil\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"fd \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" fd\\n\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token omit\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Data\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"close\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"The resource a file descriptor holds is just an integer. We definitely don’t want to use class just for automatic resource management. However, using structs means the resource can be leaked if we forget to call \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"close\"}],\" method. Even worse, if the value is copied, we totally lose control of it:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handleToFileA \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"try\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"!\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"filePath\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token string-literal\",\"style\":{\"color\":\"hsl(119, 34%, 47%)\"},\"children\":[\"\\\"/path/to/a\\\"\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" anotherHandleToFileA \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handleToFileA\\n\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"anotherHandleToFileA\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"close\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"handleToFileA\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// 💥 BOOM!\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":\"In the end, we have to avoid using structs to represent a file descriptor. What a sad story.\"}],\"\\n\",[\"$\",\"h2\",\"h2-3\",{\"children\":\"Rust to the Rescue\"}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":\"When it comes to Rust, you will find everything works just like a charm. Why?\"}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":\"First, value types don’t have to be trivial types, and they can have custom destructors:\"}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Drop\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"OwnedFd\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token attribute\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"#[inline]\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"drop\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"Opacity\":\"0.8\"},\"children\":[\"libc\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"Opacity\":\"0.8\",\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"close\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"fd\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":\"Second, all user-defined types are not copyable by default. They are moved when assigned:\"}],\"\\n\",[\"$\",\"pre\",\"pre-4\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handle_to_file_a \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"acquire_fd\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" another_handle_to_file_a \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handle_to_file_a\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// note: value moved here\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"drop\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"another_handle_to_file_a\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handle_to_file_a\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"is_terminal\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// error: borrow of moved value: `handle_to_file_a`\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":\"Third, lifetimes are checked at compile-time. As the above code shows, using a moved value will result in an error.\"}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"children\":\"While all types are value types in Rust, they can still be divided into 3 categories:\"}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"“POD” type:\"}],\" such types can be bit-wise copied, and they implement \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Copy\"}],\" trait. Instead of being moved, they are copied implicitly when assigned. Examples are \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"i32\"}],\", \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Duration\"}],\", etc.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Duplicatable type:\"}],\" they implement \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Clone\"}],\" trait and can be cloned explicitly. After cloned, the new value may refer to the same thing or another different thing, depends on the semantics of the type. Examples are \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"String\"}],\", \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Arc\"}],\", etc.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Exclusive type:\"}],\" they can’t be copied, nor can it be cloned. Examples are \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"File\"}],\", \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Box\u003cT\u003e\"}],\" (where \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"T\"}],\" is not \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Clone\"}],\"), etc.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"children\":\"These can cover almost all the cases we may meet, and the soundness is guaranteed by the compiler.\"}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"children\":[\"Another good thing of Rust is that it uses move semantics by default. With some rare exceptions (such as self-referential types), move semantics don’t make mistakes. You can progressively adopt \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Copy\"}],\" and \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"Clone\"}],\" when you find it’s safe to do so.\"]}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"children\":[\"All of these rules make up the unique feature of Rust: \",[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html\",\"children\":\"ownership\"}]}],\".\"]}],\"\\n\",[\"$\",\"h2\",\"h2-4\",{\"children\":\"Ownership in Swift\"}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"children\":[\"Swift 5.9 introduced \",[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"https://github.com/apple/swift-evolution/blob/main/proposals/0390-noncopyable-structs-and-enums.md\",\"children\":\"non-copyable types\"}]}],\", which imply unique ownership. Value types that represent underlying resources are suitable to be non-copyable. By using it, developers can no longer copy a file descriptor by mistake. And since the ownership is unique, it’s also safe to release resources when the value goes out of scope, which enables you to add \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"deinit\"}],\" to non-copyable structs / enums.\"]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"children\":[\"To make a type non-copyable, simply add \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"~Copyable\"}],\" suppression annotation:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-5\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"~\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Copyable\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  consuming \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"close\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"children\":[\"The \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"consuming\"}],\" modifier makes \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"close\"}],\" method move the receiver. Now the code below becomes invalid:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-6\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handleToFileA \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"try\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"!\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"filePath\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token string-literal\",\"style\":{\"color\":\"hsl(119, 34%, 47%)\"},\"children\":[\"\\\"/path/to/a\\\"\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" anotherHandleToFileA \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" handleToFileA\\n\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"anotherHandleToFileA\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"close\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"handleToFileA\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// error: 'handleToFileA' used after consume\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"children\":[\"Assigning a variable of non-copyable type to another will be move assignment. But sometimes you need to use a value but don’t want to move it. It’s where borrow comes into the play. By marking a function or parameter \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"borrowing\"}],\", you can borrow it without consuming it:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-7\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"~\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Copyable\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  borrowing \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token omit\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Data\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// It's ok to do this multiple times:\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"handleToFileA\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"handleToFileA\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"handleToFileA\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"write\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"children\":[\"Actually you don’t need an explicit \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"close\"}],\" method, as non-copyable types support the RAII technique. You can just release your resources in \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":\"deinit\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",\"pre-8\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"~\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"Copyable\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"deinit\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// Called when the file descriptor leaves the scope.\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"children\":\"Other functions that consume non-copyable values also take the ownership of them:\"}],\"\\n\",[\"$\",\"pre\",\"pre-9\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"flushAndClose\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token omit\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" fd\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" consuming \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// ...\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// `deinit` of `fd` is called here.\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-30\",{\"children\":\"And it’s not allowed to consume a borrowed value:\"}],\"\\n\",[\"$\",\"pre\",\"pre-10\",{\"children\":[\"$\",\"pre\",null,{\"className\":\"text-sm\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\"0.5em 0\",\"overflow\":\"auto\",\"borderRadius\":\"0.3em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-swift\",\"style\":{\"background\":\"hsl(230, 1%, 98%)\",\"color\":\"hsl(230, 8%, 24%)\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(301, 63%, 40%)\"},\"children\":[\"func\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token function-definition\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"appendSomething\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to fd\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" borrowing \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(35, 99%, 36%)\"},\"children\":[\"FileDescriptor\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(221, 87%, 60%)\"},\"children\":[\"flushAndClose\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"fd\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 4%, 64%)\",\"fontStyle\":\"italic\"},\"children\":[\"// error: 'fd' has guaranteed ownership but was consumed\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(230, 8%, 24%)\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"h2\",\"h2-5\",{\"children\":\"Closing up\"}],\"\\n\",[\"$\",\"p\",\"p-31\",{\"children\":\"Ownership is a really great feature that enables us to write memory-safe code, while not introducing additional overheads. It’s a kind of zero-cost abstraction, which is very necessary for system programming. Although Swift doesn’t have mandatory adoption requirement of ownership, you should still be aware of it and take advantage of it as much as possible.\"}]]}]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Why Ownership Matters | Zilong Zhou\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A statically generated blog example using Next.js and Zilong Zhou.\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Why Ownership Matters | Zilong Zhou\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"A statically generated blog example using Next.js and Zilong Zhou.\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:title\",\"content\":\"Why Ownership Matters | Zilong Zhou\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:description\",\"content\":\"A statically generated blog example using Next.js and Zilong Zhou.\"}],[\"$\",\"meta\",\"9\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>